<?xml version="1.0" ?>

<!--
This file is used to define the schema of the index.
It is not the real schema, but only the part to be added to the default schema.

Solr uses the managed-schema.xml file to define the schema of the index.
-->
<root>
    <managed-schema>
        <!-- Identifiers -->
        <field name="id" type="string" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="identifier" type="string" indexed="true" stored="true" multiValued="false" required="true"/>
        <!--        <copyField source="identifier" dest="id"/>-->

        <field name="identifiers" type="strings" indexed="true" stored="true" multiValued="true" required="true"
               docValues="true"/>
        <field name="datestamp" type="pdate" indexed="true" stored="true" multiValued="false"
               required="false"/> <!-- Date of last collection -->
        <field name="origin" type="origin" indexed="true" stored="true" multiValued="false" required="true"
               docValues="true" default="toto"/> <!-- Origin of the record hal, cairn or open editions -->
        <fieldType name="origin" class="solr.EnumFieldType" docValues="true" enumName="origin"
                   enumsConfig="enumsConfig.xml"/>

        <!-- Titles -->
        <field name="best_title" type="text_general" indexed="true" stored="true" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true" required="true"/>

        <field name="titles" type="text_general" indexed="true" stored="false" multiValued="true"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_Fr" type="text_fr" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_En" type="text_en" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_De" type="text_de" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_Es" type="text_es" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_It" type="text_it" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <field name="title_Ru" type="text_ru" indexed="true" stored="false" multiValued="false"
               termVectors="true" termPositions="true" termOffsets="true"/>
        <copyField source="title_*" dest="titles" maxChars="4000"/>

        <!-- Descriptions -->
        <field name="best_description" type="text_general" indexed="true" stored="true" multiValued="false"/>

        <field name="descriptions" type="text_general" indexed="true" stored="false" multiValued="true"/>
        <field name="description_Fr" type="text_fr" indexed="true" stored="false" multiValued="false"/>
        <field name="description_En" type="text_en" indexed="true" stored="false" multiValued="false"/>
        <field name="description_De" type="text_de" indexed="true" stored="false" multiValued="false"/>
        <field name="description_Es" type="text_es" indexed="true" stored="false" multiValued="false"/>
        <field name="description_It" type="text_it" indexed="true" stored="false" multiValued="false"/>
        <field name="description_Ru" type="text_ru" indexed="true" stored="false" multiValued="false"/>
        <copyField source="description_*" dest="descriptions" maxChars="8000"/>


        <!-- Number fields, automatically generated by the python script -->
        <field name="nb_titles" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_creators" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_contributors" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_subjects" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_publishers" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_languages" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>
        <field name="nb_sets" type="pint" indexed="true" stored="true" multiValued="false" required="true"/>

        <!-- Keywords (subjects) -->
        <field name="subjects" type="text_general" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_Fr" type="text_fr" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_En" type="text_en" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_De" type="text_de" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_Es" type="text_es" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_It" type="text_it" indexed="true" stored="false" multiValued="true"/>
        <field name="subjects_Ru" type="text_ru" indexed="true" stored="false" multiValued="true"/>
        <copyField source="subjects_*" dest="subjects" maxChars="4000"/>

        <!-- Creators -->
        <field name="creators" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Contributors -->
        <field name="contributors" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Publishers -->
        <field name="publishers" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Languages -->
        <field name="languages" type="languages" indexed="true" stored="true" multiValued="true" docValues="true"/>
        <fieldType name="languages" class="solr.EnumFieldType" docValues="true" enumName="languages"
                   enumsConfig="enumsConfig.xml"/>

        <!-- Sets, the groups of publications a publication belongs to -->
        <field name="sets" type="string" indexed="true" stored="true" multiValued="true" docValues="true"/>

        <!-- Dates, dates in the publication, could be publication date, creation date, etc. -->
        <field name="dates" type="pdate" indexed="true" stored="true" multiValued="true" docValues="true"/>

        <!-- Types, the type of the publication, could be article, book, etc. -->
        <field name="types" type="string" indexed="true" stored="true" multiValued="true"/>

        <!-- Formats, the format of the publication, could be pdf, epub, etc. -->
        <field name="formats" type="string" indexed="true" stored="true" multiValued="true"/>

        <!-- Coverage, maybe a useless field -->
        <field name="couvertures" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Access rights, maybe a useless field -->
        <field name="accessibilities" type="text_general" indexed="true" stored="false" multiValued="true"/>

        <!-- Sources, the source of the publication, could be any journal, book, workshop, etc. -->
        <field name="sources" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Relations, the relations of the publication, could be any journal, book, workshop, etc. -->
        <field name="relations" type="text_general" indexed="true" stored="true" multiValued="true"/>

        <!-- Rights holders, the rights holders of the publication, could be any journal, book, workshop, etc. -->
        <field name="rights" type="text_general" indexed="true" stored="true" multiValued="true"/>


        <uniqueKey>id</uniqueKey>

        <copyField source="descriptions" dest="catchall"/>
        <copyField source="titles" dest="catchall"/>
        <copyField source="subjects" dest="catchall"/>
        <copyField source="creators" dest="catchall"/>
        <copyField source="contributors" dest="catchall"/>
        <copyField source="publishers" dest="catchall"/>
        <field name="catchall" type="text_general" indexed="true" stored="false" multiValued="true"/>
    </managed-schema>

    <solrconfig>
        <schemaFactory class="ManagedIndexSchemaFactory">
            <bool name="mutable">true</bool>
            <str name="managedSchemaResourceName">managed-schema.xml</str>
        </schemaFactory>
        <queryResponseWriter name="velocity" class="solr.VelocityResponseWriter" startup="lazy">
            <str name="template.base.dir">${velocity.template.base.dir:}</str>
        </queryResponseWriter>

        <lib dir="${solr.install.dir:../../../..}/contrib/velocity/lib" regex=".*\.jar"/>
        <lib dir="${solr.install.dir:../../../..}/dist/" regex="solr-velocity-\d.*\.jar"/>
        <requestHandler name="/select" class="solr.SearchHandler">
            <lst name="defaults">
                <str name="echoParams">explicit</str>
                <int name="rows">10</int>
                <str name="df">catchall</str>
            </lst>
        </requestHandler>
        <requestHandler name="/query" class="solr.SearchHandler">
            <lst name="defaults">
                <str name="df">catchall</str>
            </lst>
        </requestHandler>

        <requestHandler name="/browse" class="solr.SearchHandler">
            <lst name="defaults">
                <str name="df">catchall</str>
                <str name="echoParams">explicit</str>

                <!-- VelocityResponseWriter settings -->
                <str name="wt">velocity</str>
                <str name="v.template">browse</str>
                <str name="v.layout">layout</str>
                <str name="title">Solritas</str>

                <!--                &lt;!&ndash; Query settings &ndash;&gt;-->
                <!--                <str name="defType">edismax</str>-->
                <!--                <str name="qf">-->
                <!--                    id^20.0-->
                <!--                    titre^10.0 contenu^5.0 mots_cles^5.0 auteur^2.0-->
                <!--                </str>-->
                <!--                <str name="mm">100%</str>-->
                <!--                <str name="q.alt">*:*</str>-->
                <!--                <str name="rows">25</str>-->
                <!--                <str name="fl">*,score</str>-->

                <!--                <str name="mlt.qf">-->
                <!--                    id^20.0-->
                <!--                    titre^10.0 contenu^5.0 mots_cles^5.0 auteur^2.0-->
                <!--                </str>-->
                <!--                <str name="mlt.fl">titre, auteur, mots_cles, contenu, id</str>-->
                <!--                <int name="mlt.count">5</int>-->

                <!-- Faceting defaults -->
                <str name="facet">on</str>
                <str name="facet.missing">true</str>
                <str name="facet.field">catchall</str>
                <!--                <str name="facet.field">mots_cles</str>-->
                <!--                <str name="facet.field">titre</str>-->
                <!--                <str name="facet.field">contenu</str>-->
                <!--                <str name="facet.query">france</str>-->
                <!--                <str name="facet.mincount">1</str>-->
                <!--                <str name="facet.pivot">cat,inStock</str>-->
                <!--                <str name="facet.range.other">after</str>-->
                <!--                <str name="facet.range">price</str>-->
                <!--                <int name="f.price.facet.range.start">0</int>-->
                <!--                <int name="f.price.facet.range.end">600</int>-->
                <!--                <int name="f.price.facet.range.gap">50</int>-->
                <!--                <str name="facet.range">popularity</str>-->
                <!--                <int name="f.popularity.facet.range.start">0</int>-->
                <!--                <int name="f.popularity.facet.range.end">10</int>-->
                <!--                <int name="f.popularity.facet.range.gap">3</int>-->
                <!--                <str name="facet.range">manufacturedate_dt</str>-->
                <!--                <str name="f.manufacturedate_dt.facet.range.start">NOW/YEAR-10YEARS</str>-->
                <!--                <str name="f.manufacturedate_dt.facet.range.end">NOW</str>-->
                <!--                <str name="f.manufacturedate_dt.facet.range.gap">+1YEAR</str>-->
                <!--                <str name="f.manufacturedate_dt.facet.range.other">before</str>-->
                <!--                <str name="f.manufacturedate_dt.facet.range.other">after</str>-->

                <!--                &lt;!&ndash; Highlighting defaults &ndash;&gt;-->
                <!--                <str name="hl">on</str>-->
                <!--                <str name="hl.fl">auteur id mots_cles titre contenu</str>-->
                <!--                <str name="hl.preserveMulti">true</str>-->
                <!--                <str name="hl.encoder">html</str>-->
                <!--                <str name="hl.simple.pre">&lt;span class="highlighted"&gt;</str>-->
                <!--                <str name="hl.simple.post">&lt;/span&gt;</str>-->
                <!--                <str name="f.title.hl.fragsize">0</str>-->
                <!--                <str name="f.title.hl.alternateField">titre</str>-->
                <!--                <str name="f.name.hl.fragsize">0</str>-->
                <!--                <str name="f.name.hl.alternateField">auteur</str>-->
                <!--                <str name="f.content.hl.snippets">10</str>-->
                <!--                <str name="f.content.hl.fragsize">500</str>-->
                <!--                <str name="f.content.hl.alternateField">contenu</str>-->
                <!--                <str name="f.content.hl.maxAlternateFieldLength">1500</str>-->

                <!--                &lt;!&ndash; Spell checking defaults &ndash;&gt;-->
                <!--                <str name="spellcheck">on</str>-->
                <!--                <str name="spellcheck.extendedResults">false</str>-->
                <!--                <str name="spellcheck.count">5</str>-->
                <!--                <str name="spellcheck.alternativeTermCount">2</str>-->
                <!--                <str name="spellcheck.maxResultsForSuggest">5</str>-->
                <!--                <str name="spellcheck.collate">true</str>-->
                <!--                <str name="spellcheck.collateExtendedResults">true</str>-->
                <!--                <str name="spellcheck.maxCollationTries">5</str>-->
                <!--                <str name="spellcheck.maxCollations">3</str>-->
            </lst>

            <!--            &lt;!&ndash; append spellchecking to our list of components &ndash;&gt;-->
            <!--            <arr name="last-components">-->
            <!--                <str>spellcheck</str>-->
            <!--            </arr>-->
        </requestHandler>

    </solrconfig>

    <enumsConfig>
        <enum name="languages">
            <value>af</value>
            <value>ar</value>
            <value>be</value>
            <value>bn</value>
            <value>bs</value>
            <value>ca</value>
            <value>cs</value>
            <value>da</value>
            <value>de</value>
            <value>el</value>
            <value>en</value>
            <value>es</value>
            <value>et</value>
            <value>eu</value>
            <value>fi</value>
            <value>fr</value>
            <value>gl</value>
            <value>he</value>
            <value>hr</value>
            <value>hu</value>
            <value>id</value>
            <value>it</value>
            <value>ja</value>
            <value>ko</value>
            <value>la</value>
            <value>lt</value>
            <value>lv</value>
            <value>mk</value>
            <value>mn</value>
            <value>nl</value>
            <value>no</value>
            <value>oc</value>
            <value>pl</value>
            <value>pt</value>
            <value>ro</value>
            <value>ru</value>
            <value>sk</value>
            <value>sl</value>
            <value>so</value>
            <value>sq</value>
            <value>sr</value>
            <value>sv</value>
            <value>tl</value>
            <value>tr</value>
            <value>uk</value>
            <value>vi</value>
            <value>zh</value>
        </enum>
        <enum name="origin">
            <value>cairn</value>
            <value>hal</value>
            <value>open editions</value>
            <value>toto</value>
        </enum>
    </enumsConfig>
</root>
